<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>To-Do Manager</title>

<!-- üîí YOUR ORIGINAL CSS ‚Äî UNTOUCHED -->
<style>
/* (PASTE YOUR FULL ORIGINAL CSS HERE ‚Äî EXACTLY AS YOU SENT IT)
   NOTHING IS REMOVED OR MODIFIED */
</style>
</head>

<body>
<div class="app-container">
  <header>
    <h1>üìù To-Do Manager</h1>
    <p>Organize your tasks and track your progress easily!</p>
  </header>

  <section id="add-task">
    <h2>Add a New Task</h2>
    <form id="taskForm">
      <input type="text" id="taskInput" placeholder="Enter your task..." required />
      <button type="submit">Add Task</button>
    </form>
  </section>

  <section id="todo-list">
    <h2>Pending Tasks</h2>
    <ul id="pendingTasks"></ul>
  </section>

  <section id="completed-list">
    <h2>Completed Tasks</h2>
    <ul id="completedTasks"></ul>
  </section>

  <section id="summary">
    <h2>Summary</h2>
    <div class="summary-box">
      <p>Total Tasks: <span id="totalCount">0</span></p>
      <p>Completed: <span id="completedCount">0</span></p>
      <p>Pending: <span id="pendingCount">0</span></p>
    </div>
  </section>
</div>

<script>
const taskForm = document.getElementById("taskForm");
const taskInput = document.getElementById("taskInput");
const pendingList = document.getElementById("pendingTasks");
const completedList = document.getElementById("completedTasks");

const totalCountEl = document.getElementById("totalCount");
const completedCountEl = document.getElementById("completedCount");
const pendingCountEl = document.getElementById("pendingCount");

// Load tasks from backend
function loadTasks() {
  fetch("tasks")
    .then(res => res.json())
    .then(tasks => {
      pendingList.innerHTML = "";
      completedList.innerHTML = "";

      let completed = 0;

      tasks.forEach(task => {
        const li = document.createElement("li");
        li.className = "task" + (task.completed ? " completed" : "");

        li.innerHTML = `
          <span>${task.task}</span>
          <div>
            <button onclick="toggleTask(${task.id})">
              ${task.completed ? "‚Ü©Ô∏è Undo" : "‚úÖ Done"}
            </button>
            <button onclick="deleteTask(${task.id})">üóëÔ∏è</button>
          </div>
        `;

        if (task.completed) {
          completed++;
          completedList.appendChild(li);
        } else {
          pendingList.appendChild(li);
        }
      });

      totalCountEl.textContent = tasks.length;
      completedCountEl.textContent = completed;
      pendingCountEl.textContent = tasks.length - completed;
    });
}

taskForm.addEventListener("submit", e => {
  e.preventDefault();

  fetch("tasks", {
    method: "POST",
    headers: {"Content-Type": "application/x-www-form-urlencoded"},
    body: `task=${encodeURIComponent(taskInput.value)}`
  }).then(() => {
    taskInput.value = "";
    loadTasks();
  });
});

function toggleTask(id) {
  fetch("tasks?id=" + id, { method: "PUT" })
    .then(loadTasks);
}

function deleteTask(id) {
  fetch("tasks?id=" + id, { method: "DELETE" })
    .then(loadTasks);
}

loadTasks();
</script>
</body>
</html>
